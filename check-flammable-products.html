<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุจุฑุฑุณ ูุญุตููุงุช ุขุชุดโุฒุง ููุฌูุฏ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .product { border: 2px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 8px; }
        .flammable { border-color: #ff4444; background-color: #ffe6e6; }
        .non-flammable { border-color: #44ff44; background-color: #e6ffe6; }
        .not-found { border-color: #ffaa00; background-color: #fff3cd; }
        h1 { color: #333; text-align: center; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .test-btn { background-color: #007bff; color: white; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; background-color: #f8f9fa; }
    </style>
</head>
<body>
    <h1>๐ ุจุฑุฑุณ ูุญุตููุงุช ุขุชุดโุฒุง ุฏุฑ ุณุณุชู</h1>
    
    <div class="product not-found">
        <h3>โ ูุญุตูู 470 (ุบุฑ ููุฌูุฏ)</h3>
        <p><strong>ูุถุนุช:</strong> ุงู ูุญุตูู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ูุฌูุฏ ูุฏุงุฑุฏ</p>
        <p><strong>ูุชุฌู:</strong> ุณุณุชู ูฺ ูุญุตูู ูพุฏุง ููโฺฉูุฏ โ ุงุชูุจูุณ ุงูุชุฎุงุจ ูโุดูุฏ</p>
        <button class="test-btn" onclick="testProduct(470)">ุชุณุช ูุญุตูู 470</button>
        <div id="result-470" class="result" style="display:none;"></div>
    </div>

    <div class="product non-flammable">
        <h3>โ ูุญุตูู 25 - Solvant 402 (ุบุฑ ุขุชุดโุฒุง)</h3>
        <p><strong>ูุถุนุช:</strong> ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูุ ุบุฑ ูุงุจู ุงุดุชุนุงู</p>
        <p><strong>ูุชุฌู:</strong> ุงุชูุจูุณ ูุฌุงุฒ ุจุฑุง ุญูู</p>
        <button class="test-btn" onclick="testProduct(25)">ุชุณุช ูุญุตูู 25</button>
        <div id="result-25" class="result" style="display:none;"></div>
    </div>

    <div class="product non-flammable">
        <h3>โ ูุญุตูู 27 - Solvant 402 (ุบุฑ ุขุชุดโุฒุง)</h3>
        <p><strong>ูุถุนุช:</strong> ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูุ ุบุฑ ูุงุจู ุงุดุชุนุงู</p>
        <p><strong>ูุชุฌู:</strong> ุงุชูุจูุณ ูุฌุงุฒ ุจุฑุง ุญูู</p>
        <button class="test-btn" onclick="testProduct(27)">ุชุณุช ูุญุตูู 27</button>
        <div id="result-27" class="result" style="display:none;"></div>
    </div>

    <div class="product flammable">
        <h3>๐ฅ ูุญุตูู 28 - Solvant 402 (ุขุชุดโุฒุง)</h3>
        <p><strong>ูุถุนุช:</strong> ููุฌูุฏ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูุ ูุงุจู ุงุดุชุนุงู</p>
        <p><strong>ูุชุฌู:</strong> ุงุชูุจูุณ ููููุน โ ฺฉุงููู ุณูฺฏู ุงูุชุฎุงุจ ูโุดูุฏ</p>
        <button class="test-btn" onclick="testProduct(28)">ุชุณุช ูุญุตูู 28 (ุขุชุดโุฒุง)</button>
        <div id="result-28" class="result" style="display:none;"></div>
    </div>

    <div style="background-color: #e7f3ff; padding: 15px; margin: 20px 0; border-radius: 8px;">
        <h3>๐ ุฎูุงุตู:</h3>
        <ul>
            <li><strong>ูุญุตูู 470:</strong> ูุฌูุฏ ูุฏุงุฑุฏ โ ุณุณุชู ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูุฏ (ุงุชูุจูุณ OK)</li>
            <li><strong>ูุญุตููุงุช 25, 27:</strong> ุบุฑ ุขุชุดโุฒุง โ ุงุชูุจูุณ ูุฌุงุฒ</li>
            <li><strong>ูุญุตูู 28:</strong> ุขุชุดโุฒุง โ ุงุชูุจูุณ ููููุน โ</li>
        </ul>
        <p><strong>ุจุฑุง ุชุณุช ุณุณุชู ุงููุ ูุญุตูู 28 ุฑุง ุงุณุชูุงุฏู ฺฉูุฏ!</strong></p>
    </div>

    <script>
        async function testProduct(productId) {
            const resultDiv = document.getElementById('result-' + productId);
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '๐ ุฏุฑ ุญุงู ุชุณุช...';

            try {
                const response = await fetch('/api/calculate-delivery-cost', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        weight: 11,
                        destinationCity: 'ฺฉุฑุจูุง',
                        destinationProvince: 'ฺฉุฑุจูุง',
                        originCity: 'ุงุฑุจู',
                        cart: { [productId]: 1 },
                        useSecondaryAddress: false
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    const vehicle = data.data.optimalVehicle;
                    const isFlammable = vehicle.vehicleName.includes('ุขุชุดโุฒุง');
                    const isBus = vehicle.vehicleName.includes('ุงุชูุจูุณ');
                    
                    let status = '';
                    if (isFlammable) {
                        status = '๐ฅ ฺฉุงููู ูุฌุงุฒ ุขุชุดโุฒุง ุงูุชุฎุงุจ ุดุฏ - ุงูู';
                    } else if (isBus) {
                        status = '๐ ุงุชูุจูุณ ุงูุชุฎุงุจ ุดุฏ';
                    } else {
                        status = '๐ ูุณูู ุฏฺฏุฑ ุงูุชุฎุงุจ ุดุฏ';
                    }
                    
                    resultDiv.innerHTML = `
                        <h4>ูุชุฌู ุชุณุช:</h4>
                        <p><strong>ูุณูู ุงูุชุฎุงุจ:</strong> ${vehicle.vehicleName}</p>
                        <p><strong>ูุฒูู:</strong> ${vehicle.totalCost.toLocaleString()} ุฏูุงุฑ</p>
                        <p><strong>ูุถุนุช ุงูู:</strong> ${status}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">ุฎุทุง: ${data.message}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">ุฎุทุง ุฏุฑ ุงุชุตุงู: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>