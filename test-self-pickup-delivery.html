<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø±ÙˆØ´ Ø­Ù…Ù„ "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…"</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            direction: rtl;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .success { background-color: #f0f9ff; border-color: #2563eb; }
        .info { background-color: #f8fafc; border-color: #64748b; }
        .api-result {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            direction: ltr;
            text-align: left;
        }
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover { background: #1d4ed8; }
        .feature-item {
            margin: 10px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            border-right: 4px solid #2563eb;
        }
        h1 { color: #1e40af; margin-bottom: 30px; }
        h2 { color: #374151; margin-top: 25px; }
        .status { font-weight: bold; }
        .status.success { color: #16a34a; }
        .status.error { color: #dc2626; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš¶â€â™‚ï¸ ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…</h1>
        
        <div class="test-section info">
            <h2>ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ</h2>
            <div class="feature-item">âœ… Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† entry Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ delivery_methods Ø¨Ø§ value: "self_pickup"</div>
            <div class="feature-item">âœ… Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† entry Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ shipping_rates Ø¨Ø§ delivery_method: "self_pickup"</div>
            <div class="feature-item">âœ… Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ bilingual-purchase-form.tsx Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²ÛŒÙ†Ù‡ "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…"</div>
            <div class="feature-item">âœ… Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù†Ù…Ø§ÛŒØ´ ÙˆÛŒÚ˜Ù‡ Ø¢Ø¨ÛŒ Ø±Ù†Ú¯ Ø¨Ø±Ø§ÛŒ self_pickup Ø¯Ø± dropdown</div>
            <div class="feature-item">âœ… Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ shipping cost = 0 Ø¨Ø±Ø§ÛŒ self_pickup</div>
            <div class="feature-item">âœ… Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ self_pickup Ø¯Ø± Ø¨Ø®Ø´ Ø¬Ø²Ø¦ÛŒØ§Øª</div>
        </div>

        <div class="test-section success">
            <h2>ğŸ” ØªØ³Øª API Endpoints</h2>
            <button onclick="testDeliveryMethods()">ØªØ³Øª API Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„</button>
            <button onclick="testShippingRates()">ØªØ³Øª API Ù†Ø±Ø®â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„</button>
            <div id="api-results"></div>
        </div>

        <div class="test-section info">
            <h2>ğŸ“Š Ø§Ù†ØªØ¸Ø§Ø±Ø§Øª ØªØ³Øª</h2>
            <p><strong>API Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„:</strong></p>
            <ul>
                <li>Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ entry Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ value: "self_pickup" Ø¨Ø§Ø´Ø¯</li>
                <li>label: "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…"</li>
                <li>icon: "ğŸš¶â€â™‚ï¸"</li>
                <li>color: "blue"</li>
                <li>baseCost: "0.00"</li>
            </ul>
            
            <p><strong>API Ù†Ø±Ø®â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„:</strong></p>
            <ul>
                <li>Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„ entry Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ deliveryMethod: "self_pickup" Ø¨Ø§Ø´Ø¯</li>
                <li>basePrice: "0.00" Ùˆ pricePerKg: "0.00"</li>
                <li>description Ø­Ø§ÙˆÛŒ "ØªØ­ÙˆÛŒÙ„ Ø­Ø¶ÙˆØ±ÛŒ" ÛŒØ§ "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…"</li>
                <li>estimatedDays: 0 (ÙÙˆØ±ÛŒ)</li>
            </ul>
        </div>

        <div class="test-section info">
            <h2>ğŸ¯ Ø§Ù‡Ø¯Ø§Ù ØªØ¬Ø§Ø±ÛŒ</h2>
            <ul>
                <li>âœ… Ú©Ø§Ù‡Ø´ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„ Ø¨Ø±Ø§ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù† Ù…Ø­Ù„ÛŒ</li>
                <li>âœ… Ø§ÙØ²Ø§ÛŒØ´ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ´ ØªØ­ÙˆÛŒÙ„</li>
                <li>âœ… ØªØ³Ù‡ÛŒÙ„ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù† Ù†Ø²Ø¯ÛŒÚ©</li>
                <li>âœ… Ú©Ø§Ù‡Ø´ Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ logistics Ø¨Ø±Ø§ÛŒ Ø³ÙØ§Ø±Ø´Ø§Øª Ù…Ø­Ù„ÛŒ</li>
                <li>âœ… Ø§Ø±Ø§Ø¦Ù‡ Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø¯Ø± Ú©Ù†Ø§Ø± smart vehicle</li>
            </ul>
        </div>

        <div class="test-section success">
            <h2>ğŸ’¡ Ù†Ø­ÙˆÙ‡ ØªØ³Øª Ø¯Ø± Frontend</h2>
            <ol>
                <li>Ø¨Ù‡ ØµÙØ­Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨Ø±ÙˆÛŒØ¯ Ùˆ Ù…Ø­ØµÙˆÙ„ÛŒ Ø±Ø§ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</li>
                <li>Ø¯Ø± ÙØ±Ù… Ø®Ø±ÛŒØ¯ØŒ Ø¨Ø®Ø´ "Ø±ÙˆØ´ ØªØ­ÙˆÛŒÙ„" Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯</li>
                <li>Ø¨Ø§ÛŒØ¯ Ú¯Ø²ÛŒÙ†Ù‡ "ğŸš¶â€â™‚ï¸ Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù… - Ø±Ø§ÛŒÚ¯Ø§Ù†" Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯</li>
                <li>Ø§ÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡ Ø¨Ø§ÛŒØ¯ Ø±Ù†Ú¯ Ø¢Ø¨ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯</li>
                <li>Ù‡Ù†Ú¯Ø§Ù… Ø§Ù†ØªØ®Ø§Ø¨ØŒ Ø¨Ø§ÛŒØ¯ Ù‡Ø²ÛŒÙ†Ù‡ Ø­Ù…Ù„ = 0 Ù†Ø´Ø§Ù† Ø¯Ù‡Ø¯</li>
                <li>Ù¾ÛŒØ§Ù… ØªÙˆØ¶ÛŒØ­ÛŒ Ø¢Ø¨ÛŒ Ø±Ù†Ú¯ Ù†ÛŒØ² Ø¨Ø§ÛŒØ¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯</li>
            </ol>
        </div>

        <div id="status" class="test-section">
            <h2>ğŸ“ˆ ÙˆØ¶Ø¹ÛŒØª ØªØ³Øª</h2>
            <div id="test-status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ø´Ø±ÙˆØ¹ ØªØ³Øª...</div>
        </div>
    </div>

    <script>
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('test-status');
            statusDiv.innerHTML = `<span class="status ${type}">${message}</span>`;
        }

        function addResult(title, data, type = 'info') {
            const resultsDiv = document.getElementById('api-results');
            const resultDiv = document.createElement('div');
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <div class="api-result">${JSON.stringify(data, null, 2)}</div>
            `;
            resultsDiv.appendChild(resultDiv);
        }

        async function testDeliveryMethods() {
            updateStatus('ØªØ³Øª API Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„...', 'info');
            try {
                const response = await fetch('/api/checkout/delivery-methods');
                const data = await response.json();
                
                addResult('ğŸ“¦ API Delivery Methods Response', data);
                
                const selfPickup = data.find(method => method.value === 'self_pickup');
                if (selfPickup) {
                    updateStatus('âœ… Ø±ÙˆØ´ Ø­Ù…Ù„ "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÛŒØ§ÙØª Ø´Ø¯!', 'success');
                    console.log('Self-pickup delivery method found:', selfPickup);
                } else {
                    updateStatus('âŒ Ø±ÙˆØ´ Ø­Ù…Ù„ "Ø­Ù…Ù„ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù…" ÛŒØ§ÙØª Ù†Ø´Ø¯!', 'error');
                }
            } catch (error) {
                updateStatus(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª API: ${error.message}`, 'error');
                addResult('âŒ API Error', error);
            }
        }

        async function testShippingRates() {
            updateStatus('ØªØ³Øª API Ù†Ø±Ø®â€ŒÙ‡Ø§ÛŒ Ø­Ù…Ù„...', 'info');
            try {
                const response = await fetch('/api/shipping-rates');
                const result = await response.json();
                
                addResult('ğŸšš API Shipping Rates Response', result);
                
                if (result.success && result.data) {
                    const selfPickupRate = result.data.find(rate => rate.deliveryMethod === 'self_pickup');
                    if (selfPickupRate) {
                        updateStatus('âœ… Ù†Ø±Ø® Ø­Ù…Ù„ "self_pickup" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÛŒØ§ÙØª Ø´Ø¯!', 'success');
                        console.log('Self-pickup shipping rate found:', selfPickupRate);
                    } else {
                        updateStatus('âŒ Ù†Ø±Ø® Ø­Ù…Ù„ "self_pickup" ÛŒØ§ÙØª Ù†Ø´Ø¯!', 'error');
                    }
                } else {
                    updateStatus('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø±Ø® Ø­Ù…Ù„', 'error');
                }
            } catch (error) {
                updateStatus(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª API: ${error.message}`, 'error');
                addResult('âŒ API Error', error);
            }
        }

        // Auto-run tests on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø±...', 'info');
            setTimeout(() => {
                testDeliveryMethods();
                setTimeout(() => {
                    testShippingRates();
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>